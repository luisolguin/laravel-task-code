use App\Models\Note; use App\Models\Tag; use Illuminate\Support\Str; $notes = Note::all(); $updatedCount = 0; echo "Actualizando el contenido de las notas con sus etiquetas...\n"; foreach ($notes as $note) { $tagNames = $note->tags->map(function ($tag) { return '#' . $tag->name; })->implode(' '); if (!empty($tagNames)) { $originalContent = Str::finish(trim($note->content), '.'); $cleanContent = preg_replace('/#([a-zA-Z0-9]+)\b/', '', $originalContent); $cleanContent = trim($cleanContent); $newContent = $cleanContent . " Etiquetas de la nota: " . $tagNames; if ($note->content !== $newContent) { $note->content = $newContent; $note->save(); $updatedCount++; echo "Nota ID: {$note->id} actualizada. Contenido ahora incluye: {$tagNames}\n"; } } } echo "\nProceso completado. Se actualizaron {$updatedCount} notas.\n";